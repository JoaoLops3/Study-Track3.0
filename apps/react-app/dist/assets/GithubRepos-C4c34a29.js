import{j as e}from"./ui-BN-0vsY4.js";import{r as d}from"./vendor-1oV-3_XS.js";import{a as y,G as k,s as x,e as l}from"./index-Kc8VGIUG.js";import{G as j}from"./GithubConnectButton-DfiEX7DP.js";const _=()=>{const{settings:i,updateSettings:m}=y(),[p,b]=d.useState([]),[g,h]=d.useState(!0);return d.useEffect(()=>{(async()=>{var t,u,o,n;try{if(!i.integrations.github){h(!1);return}const{data:{session:s}}=await x.auth.getSession();if(!s){l.error("Sessão expirada. Por favor, faça login novamente.");return}const a=s.provider_token||((n=(o=(u=(t=s.user)==null?void 0:t.identities)==null?void 0:u[0])==null?void 0:o.identity_data)==null?void 0:n.access_token);if(console.log("Token do GitHub (session):",a),!a){l.error("Token do GitHub não encontrado. Por favor, reconecte sua conta.");return}const c=await fetch("https://api.github.com/user/repos",{headers:{Authorization:`token ${a}`,Accept:"application/vnd.github.v3+json"}});if(!c.ok){if(c.status===401){l.error("Token do GitHub expirado. Por favor, reconecte sua conta.");return}throw new Error("Erro ao buscar repositórios")}const f=await c.json();b(f)}catch(s){console.error("Erro:",s),l.error("Erro ao carregar repositórios")}finally{h(!1)}})()},[i.integrations.github]),d.useEffect(()=>{(async()=>{var o,n,s,a;const{data:{session:t}}=await x.auth.getSession();((t==null?void 0:t.provider_token)||((a=(s=(n=(o=t==null?void 0:t.user)==null?void 0:o.identities)==null?void 0:n.find(c=>c.provider==="github"))==null?void 0:s.identity_data)==null?void 0:a.access_token))&&!i.integrations.github&&await m({integrations:{...i.integrations,github:!0}})})()},[]),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(k,{className:"w-8 h-8 text-gray-900 dark:text-white mr-3"}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Meus Repositórios GitHub"})]}),e.jsx(j,{variant:"primary"})]}),!i.integrations.github&&!g&&e.jsx("div",{className:"text-center py-12 bg-white dark:bg-gray-800 rounded-lg shadow",children:e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:"Conecte sua conta do GitHub para ver seus repositórios."})}),g?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:p.map(r=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 hover:shadow-lg transition-shadow duration-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:r.name}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4 line-clamp-2",children:r.description||"Sem descrição"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:r.language||"N/A"}),e.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:["⭐ ",r.stargazers_count]})]}),e.jsx("a",{href:r.html_url,target:"_blank",rel:"noopener noreferrer",className:"mt-4 inline-block text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300",children:"Ver no GitHub →"})]},r.id))})]})};export{_ as default};
