import{j as e}from"./ui-BN-0vsY4.js";import{j as g,b,r as o}from"./vendor-1oV-3_XS.js";import{c as j,u as w,s as l}from"./index-Kc8VGIUG.js";import{m as N}from"./proxy-DdY2QGUC.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=j("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),I=()=>{const{inviteId:i}=g(),n=b(),{user:d}=w(),[u,t]=o.useState(!0),[x,a]=o.useState(null),[c,p]=o.useState(null),[m,f]=o.useState(null);o.useEffect(()=>{if(!i){a("Convite inválido"),t(!1);return}h()},[i]);const h=async()=>{try{const{data:r,error:s}=await l.from("team_invites").select(`
          *,
          teams (
            name,
            description
          )
        `).eq("id",i).single();if(s)throw s;if(!r){a("Convite não encontrado"),t(!1);return}if(r.status!=="pending"){a("Este convite já foi usado ou expirou"),t(!1);return}if(new Date(r.expires_at)<new Date){a("Este convite expirou"),t(!1);return}p(r),f(r.teams),t(!1)}catch(r){console.error("Error fetching invite:",r),a("Erro ao carregar convite"),t(!1)}},v=async()=>{if(!d){n("/login",{state:{returnTo:`/team/invite/${i}`}});return}try{if(t(!0),d.email!==c.email){a("Este convite foi enviado para outro email"),t(!1);return}const{error:r}=await l.from("team_invites").update({status:"accepted"}).eq("id",i);if(r)throw r;const{error:s}=await l.from("team_members").insert([{team_id:c.team_id,user_id:d.id,role:c.role}]);if(s)throw s;n("/team")}catch(r){console.error("Error accepting invite:",r),a("Erro ao aceitar convite"),t(!1)}},y=async()=>{try{t(!0);const{error:r}=await l.from("team_invites").update({status:"rejected"}).eq("id",i);if(r)throw r;n("/team")}catch(r){console.error("Error rejecting invite:",r),a("Erro ao rejeitar convite"),t(!1)}};return u?e.jsx("div",{className:"flex items-center justify-center h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-500"})}):x?e.jsxs("div",{className:"flex flex-col items-center justify-center h-screen",children:[e.jsx(E,{className:"w-16 h-16 text-red-500 mb-4"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Erro"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:x}),e.jsx("button",{onClick:()=>n("/team"),className:"px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors",children:"Voltar para Equipes"})]}):e.jsx(N.div,{initial:{opacity:0},animate:{opacity:1},className:"flex flex-col items-center justify-center h-screen p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl p-8 max-w-md w-full",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Convite para Equipe"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:m.name}),m.description&&e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:m.description})]}),e.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4",children:e.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Você foi convidado para participar desta equipe como"," ",e.jsx("span",{className:"font-medium",children:c.role==="admin"?"Administrador":"Membro"})]})}),e.jsxs("div",{className:"flex space-x-4 pt-4",children:[e.jsx("button",{onClick:y,className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"Recusar"}),e.jsx("button",{onClick:v,className:"flex-1 px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors",children:"Aceitar"})]})]})]})})};export{I as default};
